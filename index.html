<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Treino de Kana</title>
  <style>
    /* --- SEU CSS ORIGINAL (INTOCADO) --- */
    body { font-family: sans-serif; text-align: center; margin: 40px; }
    table { margin: 0 auto; border-collapse: collapse; }
    td, th {
      border: 1px solid #aaa;
      padding: 10px;
      font-size: 28px;
      text-align: center;
      min-width: 50px;
    }
    label { cursor: pointer; display: block; }
    .kana { font-size: 120px; margin: 20px; }
    #feedback { font-size: 20px; margin-top: 10px; height: 24px; }

    .page { display: none; }

    .menu {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      margin-top: 30px;
    }

    .menu button {
      width: 250px;
      font-size: 22px;
      padding: 15px 30px;
      cursor: pointer;
    }

    .selection-controls {
      margin-bottom: 15px;
    }
    .selection-controls button {
      font-size: 14px;
      padding: 5px 10px;
      margin: 0 5px;
      cursor: pointer;
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .selection-controls button:hover {
      background-color: #e0e0e0;
    }

    /* --- CSS ADICIONAL (APENAS PARA O FEATURE DE ERROS) --- */
    
    /* Container para colocar o jogo e os stats lado a lado */
    .game-wrapper {
      display: flex;
      justify-content: center;
      align-items: flex-start; /* Alinha no topo */
      gap: 40px; /* Espa√ßo entre o Kanji e os erros */
    }

    /* O lado esquerdo (o jogo em si) */
    .game-main {
      flex: 1;
      text-align: right; /* Empurra o conte√∫do para perto do centro */
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* O lado direito (Painel de erros) */
    .stats-box {
      width: 150px;
      text-align: left;
      border: 2px solid #ffcccc;
      background-color: #fff5f5;
      padding: 15px;
      border-radius: 8px;
      display: none; /* Aparece s√≥ quando inicia */
    }

    .stats-title {
      font-size: 14px;
      font-weight: bold;
      color: #d32f2f;
      margin-bottom: 5px;
    }

    .error-number {
      font-size: 40px;
      font-weight: bold;
      color: #d32f2f;
      margin: 5px 0;
    }

    .wrong-chars {
      font-size: 24px;
      color: #b71c1c;
      letter-spacing: 5px;
      word-wrap: break-word;
    }
  </style>
</head>
<body>

  <div id="home" class="page" style="display:block;">
    <h1>Treinos de Japon√™s</h1>
    <div class="menu">
      <button onclick="showPage('hiragana')">Hiragana</button>
      <button onclick="showPage('katakana')">Katakana</button>
      <button onclick="showPage('numeros')">N√∫meros (1‚Äì10)</button>
      <button onclick="window.location.href='numeros.html'">
          N√∫meros (1-100)
      </button>
      <button onclick="window.location.href='vocabulario.html'">
          Flashcards de Vocabul√°rio
      </button>
    </div>
  </div>

  <div id="hiragana" class="page">
    <h2>Selecione os Hiragana</h2>
    
    <div class="selection-controls">
      <button onclick="toggleAll('table-container', true)">Selecionar Todos</button>
      <button onclick="toggleAll('table-container', false)">Limpar Todos</button>
    </div>

    <div id="table-container"></div>
    <br> <button id="start-hira">Iniciar treino</button>
    <hr>

    <div id="app-hira" class="game-wrapper" style="display:none;">
      
      <div class="game-main">
        <div class="kana" id="kana-hira"></div>
        <input id="answer-hira" placeholder="romaniza√ß√£o..." autocomplete="off">
        <p id="feedback-hira"></p>
      </div>

      <div class="stats-box" id="stats-hira">
        <div class="stats-title">ERROS</div>
        <div class="error-number" id="count-hira">0</div>
        <div class="stats-title">LETRAS:</div>
        <div class="wrong-chars" id="list-hira"></div>
      </div>

    </div>

    <button onclick="showPage('home')">Voltar</button>
  </div>

  <div id="katakana" class="page">
    <h2>Selecione os Katakana</h2>
    
    <div class="selection-controls">
      <button onclick="toggleAll('table-kata', true)">Selecionar Todos</button>
      <button onclick="toggleAll('table-kata', false)">Limpar Todos</button>
    </div>

    <div id="table-kata"></div>
    <br>
    <button id="start-kata">Iniciar treino</button>
    <hr>

    <div id="app-kata" class="game-wrapper" style="display:none;">
      
      <div class="game-main">
        <div class="kana" id="kana-kata"></div>
        <input id="answer-kata" placeholder="romaniza√ß√£o..." autocomplete="off">
        <p id="feedback-kata"></p>
      </div>

      <div class="stats-box" id="stats-kata">
        <div class="stats-title">ERROS</div>
        <div class="error-number" id="count-kata">0</div>
        <div class="stats-title">LETRAS:</div>
        <div class="wrong-chars" id="list-kata"></div>
      </div>

    </div>

    <button onclick="showPage('home')">Voltar</button>
  </div>

  <div id="numeros" class="page">
    <h2>Treino de N√∫meros (1‚Äì10)</h2>

    <button id="start-num">Iniciar treino</button>

    <hr>

    <div id="app-num" class="game-wrapper" style="display:none;">
      
      <div class="game-main">
        <div class="kana" id="kana-num"></div>
        <input id="answer-num" placeholder="romaniza√ß√£o..." autocomplete="off">
        <p id="feedback-num"></p>
      </div>

      <div class="stats-box" id="stats-num">
        <div class="stats-title">ERROS</div>
        <div class="error-number" id="count-num">0</div>
        <div class="stats-title">LETRAS:</div>
        <div class="wrong-chars" id="list-num"></div>
      </div>

    </div>

    <button onclick="showPage('home')">Voltar</button>
  </div>



<script>
// --- Controle de p√°ginas ---
function showPage(id) {
  document.querySelectorAll(".page").forEach(p => p.style.display = "none");
  document.getElementById(id).style.display = "block";
}

// --- Fun√ß√£o: Selecionar/Desmarcar Todos ---
function toggleAll(containerId, state) {
  const container = document.getElementById(containerId);
  const checkboxes = container.querySelectorAll('input[type="checkbox"]');
  checkboxes.forEach(cb => cb.checked = state);
}

// --- FUN√á√ïES DE ESTAT√çSTICA (NOVO) ---
let errorCount = 0;
let errorList = [];

function resetStats(type) {
  errorCount = 0;
  errorList = [];
  document.getElementById(`count-${type}`).textContent = "0";
  document.getElementById(`list-${type}`).textContent = "";
  document.getElementById(`stats-${type}`).style.display = "block"; // Mostra a caixa
}

function addError(type, char) {
  errorCount++;
  errorList.push(char);
  
  document.getElementById(`count-${type}`).textContent = errorCount;
  // Adiciona espa√ßo entre as letras
  document.getElementById(`list-${type}`).textContent = errorList.join(" "); 
}


// ------------ TABELAS BASE -------------------

const VOGAIS = ["A","I","U","E","O"];

const HIRAGANA_TABLE = {
  "":  { "A":"„ÅÇ","I":"„ÅÑ","U":"„ÅÜ","E":"„Åà","O":"„Åä" },
  "K": { "A":"„Åã","I":"„Åç","U":"„Åè","E":"„Åë","O":"„Åì" },
  "S": { "A":"„Åï","I":"„Åó","U":"„Åô","E":"„Åõ","O":"„Åù" },
  "T": { "A":"„Åü","I":"„Å°","U":"„Å§","E":"„Å¶","O":"„Å®" },
  "N": { "A":"„Å™","I":"„Å´","U":"„Å¨","E":"„Å≠","O":"„ÅÆ" },
  "H": { "A":"„ÅØ","I":"„Å≤","U":"„Åµ","E":"„Å∏","O":"„Åª" },
  "M": { "A":"„Åæ","I":"„Åø","U":"„ÇÄ","E":"„ÇÅ","O":"„ÇÇ" },
  "Y": { "A":"„ÇÑ",       "U":"„ÇÜ",       "O":"„Çà" },
  "R": { "A":"„Çâ","I":"„Çä","U":"„Çã","E":"„Çå","O":"„Çç" },
  "W": { "A":"„Çè",                     "O":"„Çí" },
  "N (Final)": { "A":"„Çì" }
};

const KATAKANA_TABLE = {
  "":  { "A":"„Ç¢","I":"„Ç§","U":"„Ç¶","E":"„Ç®","O":"„Ç™" },
  "K": { "A":"„Ç´","I":"„Ç≠","U":"„ÇØ","E":"„Ç±","O":"„Ç≥" },
  "S": { "A":"„Çµ","I":"„Ç∑","U":"„Çπ","E":"„Çª","O":"„ÇΩ" },
  "T": { "A":"„Çø","I":"„ÉÅ","U":"„ÉÑ","E":"„ÉÜ","O":"„Éà" },
  "N": { "A":"„Éä","I":"„Éã","U":"„Éå","E":"„Éç","O":"„Éé" },
  "H": { "A":"„Éè","I":"„Éí","U":"„Éï","E":"„Éò","O":"„Éõ" },
  "M": { "A":"„Éû","I":"„Éü","U":"„É†","E":"„É°","O":"„É¢" },
  "Y": { "A":"„É§",       "U":"„É¶",       "O":"„É®" },
  "R": { "A":"„É©","I":"„É™","U":"„É´","E":"„É¨","O":"„É≠" },
  "W": { "A":"„ÉØ",                     "O":"„É≤" },
  "N (Final)": { "A":"„É≥" }
};

// --- ROMAJI MAP ---
const ROMAJI_MAP = {};

for (const cons in HIRAGANA_TABLE) {
  for (const vow in HIRAGANA_TABLE[cons]) {
    ROMAJI_MAP[HIRAGANA_TABLE[cons][vow]] = (cons + vow).toLowerCase().replace("(final)a", ""); 
  }
}
ROMAJI_MAP["„Çì"] = "n"; ROMAJI_MAP["„É≥"] = "n";

ROMAJI_MAP["„Åó"] = "shi"; ROMAJI_MAP["„Å°"] = "chi";
ROMAJI_MAP["„Å§"] = "tsu"; ROMAJI_MAP["„Åµ"] = "fu";
ROMAJI_MAP["„Çí"] = "wo";

for (const cons in KATAKANA_TABLE) {
  for (const vow in KATAKANA_TABLE[cons]) {
    if(KATAKANA_TABLE[cons][vow] !== "„É≥")
        ROMAJI_MAP[KATAKANA_TABLE[cons][vow]] = (cons + vow).toLowerCase();
  }
}
ROMAJI_MAP["„Ç∑"] = "shi"; ROMAJI_MAP["„ÉÅ"] = "chi";
ROMAJI_MAP["„ÉÑ"] = "tsu"; ROMAJI_MAP["„Éï"] = "fu";
ROMAJI_MAP["„É≤"] = "wo";


// --- Shuffle ---
function shuffle(array) {
  for (let i = array.length -1; i>0; i--){
    const j = Math.floor(Math.random()*(i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// --- Tabela de Hiragana ---
const contHira = document.getElementById("table-container");
const tableHira = document.createElement("table");

let head = document.createElement("tr");
head.appendChild(document.createElement("th"));
VOGAIS.forEach(v => {
  const th = document.createElement("th");
  th.textContent = v;
  head.appendChild(th);
});
tableHira.appendChild(head);

for (const cons in HIRAGANA_TABLE) {
  const tr = document.createElement("tr");
  const th = document.createElement("th");
  th.textContent = cons.replace(" (Final)", ""); 
  tr.appendChild(th);

  VOGAIS.forEach(v => {
    const td = document.createElement("td");
    if (HIRAGANA_TABLE[cons][v]) {
      td.innerHTML = `<label><input type="checkbox" value="${HIRAGANA_TABLE[cons][v]}"> ${HIRAGANA_TABLE[cons][v]}</label>`;
    }
    tr.appendChild(td);
  });
  tableHira.appendChild(tr);
}
contHira.appendChild(tableHira);


// --- Tabela de Katakana ---
const contKata = document.getElementById("table-kata");
const tableKata = document.createElement("table");

let head2 = document.createElement("tr");
head2.appendChild(document.createElement("th"));
VOGAIS.forEach(v => {
  const th = document.createElement("th");
  th.textContent = v;
  head2.appendChild(th);
});
tableKata.appendChild(head2);

for (const cons in KATAKANA_TABLE) {
  const tr = document.createElement("tr");
  const th = document.createElement("th");
  th.textContent = cons.replace(" (Final)", "");
  tr.appendChild(th);

  VOGAIS.forEach(v => {
    const td = document.createElement("td");
    if (KATAKANA_TABLE[cons][v]) {
      td.innerHTML = `<label><input type="checkbox" value="${KATAKANA_TABLE[cons][v]}"> ${KATAKANA_TABLE[cons][v]}</label>`;
    }
    tr.appendChild(td);
  });
  tableKata.appendChild(tr);
}
contKata.appendChild(tableKata);


// ----------------- L√≥gica Hiragana -----------------
let hiraSel = [];
let hiraIdx = 0;

document.getElementById("start-hira").onclick = () => {
  hiraSel = [...document.querySelectorAll("#table-container input:checked")].map(x => x.value);

  if (hiraSel.length === 0) {
    alert("Selecione pelo menos 1 hiragana!");
    return;
  }

  hiraSel = shuffle(hiraSel);
  hiraIdx = 0;

  // Reseta stats
  resetStats('hira');

  // Muda display para flex para mostrar a caixa lateral
  document.getElementById("app-hira").style.display = "flex"; 
  showHira();
};

function showHira() {
  document.getElementById("feedback-hira").textContent = "";
  document.getElementById("answer-hira").value = "";
  document.getElementById("kana-hira").textContent = hiraSel[hiraIdx];
  document.getElementById("answer-hira").focus(); 
}

document.getElementById("answer-hira").addEventListener("keyup", e => {
  if (e.key !== "Enter") return;

  const cur = hiraSel[hiraIdx];
  const ok = ROMAJI_MAP[cur];

  if (e.target.value.trim().toLowerCase() === ok) {
    document.getElementById("feedback-hira").textContent = "‚úîÔ∏è Correto!";
    document.getElementById("feedback-hira").style.color = "green"; 
    hiraIdx++;
    if (hiraIdx >= hiraSel.length) {
      document.getElementById("feedback-hira").textContent = "üéâ Fim!";
      document.getElementById("kana-hira").textContent = "";
      return;
    }
    setTimeout(showHira, 600);
  } else {
    document.getElementById("feedback-hira").textContent = "‚ùå Errado!";
    document.getElementById("feedback-hira").style.color = "red";
    // ADD ERRO
    addError('hira', cur);
    e.target.value = ""; // Limpa input
  }
});


// ----------------- L√≥gica Katakana -----------------
let kataSel = [];
let kataIdx = 0;

document.getElementById("start-kata").onclick = () => {
  kataSel = [...document.querySelectorAll("#table-kata input:checked")].map(x => x.value);

  if (kataSel.length === 0) {
    alert("Selecione pelo menos 1 katakana!");
    return;
  }

  kataSel = shuffle(kataSel);
  kataIdx = 0;

  resetStats('kata');
  document.getElementById("app-kata").style.display = "flex";
  showKata();
};

function showKata() {
  document.getElementById("feedback-kata").textContent = "";
  document.getElementById("answer-kata").value = "";
  document.getElementById("kana-kata").textContent = kataSel[kataIdx];
  document.getElementById("answer-kata").focus();
}

document.getElementById("answer-kata").addEventListener("keyup", e => {
  if (e.key !== "Enter") return;

  const cur = kataSel[kataIdx];
  const ok = ROMAJI_MAP[cur];

  if (e.target.value.trim().toLowerCase() === ok) {
    document.getElementById("feedback-kata").textContent = "‚úîÔ∏è Correto!";
    document.getElementById("feedback-kata").style.color = "green";
    kataIdx++;
    if (kataIdx >= kataSel.length) {
      document.getElementById("feedback-kata").textContent = "üéâ Fim!";
      document.getElementById("kana-kata").textContent = "";
      return;
    }
    setTimeout(showKata, 600);
  } else {
    document.getElementById("feedback-kata").textContent = "‚ùå Errado!";
    document.getElementById("feedback-kata").style.color = "red";
    // ADD ERRO
    addError('kata', cur);
    e.target.value = "";
  }
});


// ------------------ TREINO DE N√öMEROS --------------------

const NUMS = [
  { jp: "‰∏Ä (1)", romaji: "ichi" },
  { jp: "‰∫å (2)", romaji: "ni" },
  { jp: "‰∏â (3)", romaji: "san" },
  { jp: "Âõõ (4)", romaji: "yon" },
  { jp: "‰∫î (5)", romaji: "go" },
  { jp: "ÂÖ≠ (6)", romaji: "roku" },
  { jp: "‰∏É (7)", romaji: "nana" },
  { jp: "ÂÖ´ (8)", romaji: "hachi" },
  { jp: "‰πù (9)", romaji: "kyuu" },
  { jp: "ÂçÅ (10)", romaji: "juu" }
];

let numsList = [];
let numIndex = 0;

document.getElementById("start-num").onclick = () => {
  numsList = shuffle([...NUMS]);
  numIndex = 0;
  
  resetStats('num');
  document.getElementById("app-num").style.display = "flex";
  showNum();
};

function showNum() {
  document.getElementById("feedback-num").textContent = "";
  document.getElementById("answer-num").value = "";
  document.getElementById("kana-num").textContent = numsList[numIndex].jp;
  document.getElementById("answer-num").focus();
}

document.getElementById("answer-num").addEventListener("keyup", (e) => {
  if (e.key !== "Enter") return;

  const current = numsList[numIndex];

  if (e.target.value.trim().toLowerCase() === current.romaji) {
    document.getElementById("feedback-num").textContent = "‚úîÔ∏è Correto!";
    document.getElementById("feedback-num").style.color = "green";
    numIndex++;
    if (numIndex >= numsList.length) {
      document.getElementById("feedback-num").textContent = "üéâ Fim!";
      document.getElementById("kana-num").textContent = "";
      return;
    }
    setTimeout(showNum, 600);
  } else {
    document.getElementById("feedback-num").textContent = "‚ùå Errado!";
    document.getElementById("feedback-num").style.color = "red";
    // ADD ERRO
    addError('num', current.jp);
    e.target.value = "";
  }
});
</script>

</body>
</html>